<!-- Copyright Indra Sistemas, S.A. 2013-2018 SPAIN -->
<html xmlns:th="http://www.thymeleaf.org" xmlns:dt="http://www.thymeleaf.org/dandelion/datatables" th:with="lang=${#locale.language}" th:lang="${lang}">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
		<meta http-equiv="Content-Language" th:content="${lang}"/>
		<title th:text="#{name.app}"/>
	    <meta name="description" content="Dashboard list template"/>
		<meta name="keywords" content="sofia2,smart,cities,platform,Indra"/>
		<meta name="author" content="Indra Sistemas, S.A."/>
		
	</head>	
	<script th:src="@{/static/vendor/jquery/jquery.min.js}"/>
	<script src="../env/env.js"></script>
	<script src="/controlpanel/static/js/pages/dashboardMessageHandler.js"></script>
	<input id="oauthtoken" type="hidden" th:value="${session.oauthToken}"/>

  	<script>
	    window.__env = window.__env || {};
	    window.__env.socketEndpointConnect = '/dashboardengine/dsengine/solver';
	    window.__env.socketEndpointSend = '/dsengine/solver';
	    window.__env.socketEndpointSubscribe = '/dsengine/broker';
	    window.__env.endpointControlPanel = '/controlpanel';
	    window.__env.endpointDashboardEngine = '/dashboardengine';
	    window.__env.dashboardEngineUsername = '';
		window.__env.dashboardEnginePassword = '';
		window.__env.dashboardEngineOauthtoken = getOauthtoken();
	    window.__env.dashboardEngineLoginRest = '/loginRest';
	    window.__env.enableDebug = false;
	    window.__env.restUrl = '';
	    window.__env.urlParameters = getURLParameters(); 
	  
	// <![CDATA[  
		 
     //Function that catch url parameters and return these like a map   
     function getURLParameters()
 		{	    	 
	 	    var sPageURL = window.location.search.substring(1);	
	 	    var sURLVariables = sPageURL.split('&');	
	 	    var urlParametersMap={};
	 	    for (var i = 0; i < sURLVariables.length; i++){
	 	    	if(sURLVariables[i].length>0){	 	    		
	 	       		var sParameterName = sURLVariables[i].split('=');
	 	    		if(sParameterName[0]!=="oauthtoken"){	 	    			
	 	       			urlParametersMap[sParameterName[0]] = sParameterName[1];
	 	    		}
	 	    	}
	 	    } 	   
	 	    
	 	    return urlParametersMap;
 	    }
     
     function getURLParameterOauthtoken()
		{	    	 
	 	    var sPageURL = window.location.search.substring(1);	
	 	    var sURLVariables = sPageURL.split('&');	
	 	    var urlParametersMap={};
	 	    for (var i = 0; i < sURLVariables.length; i++)	
	 	    {
	 	    	if(sURLVariables[i].length>0){
	 	       		var sParameterName = sURLVariables[i].split('=');	 	       		
	 	       		if(sParameterName[0]==="oauthtoken"){
	 	       			return sParameterName[1]
	 	       		}	 	       		
	 	    	}
	 	    }    
	 	   return null;
	    }
     
	     function getOauthtoken(){
	    	 
	    	
	 		if(typeof document.getElementById("oauthtoken").value!== "undefined" && document.getElementById("oauthtoken").value.length>0 ){
	 		
	 			return  document.getElementById("oauthtoken").value;
	 		}else{
	 		
	 			return getURLParameterOauthtoken();
	 		}
	 	}
        // ]]>  

  
		
	
	</script>

	
	
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
	
	<link rel="stylesheet" href="/controlpanel/static/dashboards/styles/vendor.css"/>
	
	<link rel="stylesheet" href="/controlpanel/static/dashboards/gridster.css"/>
	
	<link rel="stylesheet" href="/controlpanel/static/dashboards/styles/app.css"/>

 
	<!-- page-sidebar-closed to start page with collapsed menu -->
	<body ng-app="dashboardFramework" class="layout-column">

	<!-- MAIN PAGE WRAPPER -->
	<div class="page-wrapper">
		<dashboard  selectedpage="0" th:id="${dashboard.id}" th:attr="public=${dashboard.public},editmode=${edition},iframe=${iframe}" class="flex layout-column"></dashboard>
	</div>
	
	<script src="/controlpanel/static/dashboards/scripts/vendor.js"></script>
										
	<script src="/controlpanel/static/dashboards/gridster.js"></script>
	
	<!-- Angular Material Fileinput -->
	<link rel="stylesheet" href="/controlpanel/static/dashboards/resources/lf-ng-md-file-input.min.css"/>
	<script src="/controlpanel/static/dashboards/resources/lf-ng-md-file-input.min.js"></script>
	
	<script src="/controlpanel/static/dashboards/scripts/app.js"></script>
	

</body>
</html> 